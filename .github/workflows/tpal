# This workflow is designed to build and deploy an application
# (like one exported from Google AI Studio) to Vercel via GitHub Actions.

name: Deploy AI Studio App to Vercel

# Controls when the workflow will run
on:
  # Triggers the workflow on push events but only for the "main" branch
  push:
    branches: [ "main" ]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

# A workflow run is made up of one or more jobs
jobs:
  build_and_deploy:
    # The type of runner that the job will run on
    runs-on: ubuntu-latest

    # Environment variables for the Vercel Action
    env:
      # The Vercel project ID, find this in your Vercel project settings
      VERCEL_ORG_ID: ${{ secrets.VERCEL_ORG_ID }}
      # The Vercel organization ID
      VERCEL_PROJECT_ID: ${{ secrets.VERCEL_PROJECT_ID }}
      # Your Gemini API Key or other relevant AI API key
      GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}

    steps:
      - name: ‚¨áÔ∏è Checkout Repository
        # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
        uses: actions/checkout@v4
      
      - name: ‚öôÔ∏è Setup Node.js
        # AI Studio apps are often React/Next.js/Node.js-based
        uses: actions/setup-node@v4
        with:
          node-version: '20' # Use a recommended stable version

      - name: üì¶ Install Dependencies
        # Install all packages defined in package.json
        run: npm install

      - name: üèóÔ∏è Build Project
        # Run the standard build command. Vercel automatically detects the framework
        # but running the build explicitly is good practice.
        run: npm run build

      - name: üöÄ Deploy to Vercel
        # This action simplifies deployment to Vercel
        uses: amondnet/vercel-action@v25
        with:
          # Vercel CLI token (required for authentication)
          vercel-token: ${{ secrets.VERCEL_TOKEN }} 
          # Environment variables to pass to the Vercel deployment build process
          vercel-args: '--prod' # Deploy to the production environment
          # Note: Environment variables (like GEMINI_API_KEY) should be configured 
          # directly in your Vercel project settings for the safest deployment.
          # If you need them for the *build* step, you might pass them here 
          # or ensure the `npm run build` step uses them.
